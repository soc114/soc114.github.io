---
title: "Summary Statistics"
---

> Topic for 1/7.

We often want to take a distribution and convert it to a **summary statistic**: a one-number parameter that summarizes a fact about the distribution. A summary statistic collapses the entire distribution down to a single number.

In this example, we will continue with the household income data from the previous page. You can load the data with the code below.

```{r, eval = F}
library(tidyverse)
incomeSimulated <- read_csv("https://soc114.github.io/data/incomeSimulated.csv")
```
```{r, echo = F}
library(tidyverse)
incomeSimulated <- read_csv("../data/incomeSimulated.csv")
```

One summary statistic is the median: the value at which 50\% of households have higher incomes and 50\% of households have lower incomes.

```{r, echo = F, comment = F, message = F, warning = F, fig.width = 6, fig.height = 2}
library(haven)
prepared <- read_dta("../data_raw/prepared.dta")
summaries <- prepared |>
  summarize(median = Hmisc::wtd.quantile(hhincome, weights = asecwth,
                                       probs = .5),
            q10 = Hmisc::wtd.quantile(hhincome, weights = asecwth,
                                    probs = .1),
            q90 = Hmisc::wtd.quantile(hhincome, weights = asecwth,
                                    probs = .9),
            over_top = weighted.mean(hhincome > 500e3,
                                    w = asecwth),
            .groups = "drop")
p <- prepared |>
  filter(hhincome < 500e3) |>
  ggplot(aes(x = hhincome, weight = asecwth)) +
  geom_histogram(binwidth = 25e3, alpha = .4) +
  scale_x_continuous(labels = scales::label_dollar(),
                     name = "Household Income") +
  scale_y_continuous(breaks = NULL,
                     name = "Density") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 30, hjust = 1),
        panel.grid.minor = element_blank()) +
  theme_bw()
p +
  geom_vline(xintercept = summaries$median,
             color = "blue", size = 2) +
  annotate(geom = "text", color = "blue", size = 4,
           x = 300e3, y = 2e7,
           label = paste("Median =",scales::dollar(summaries$median)),
           fontface = "bold")
#ggsave("../slides/lec1/us2022_hh_dist_median.pdf",
#       height = 3, width = 4.5)
```

You can produce the median using the simulated data [`incomeSimulated.csv`](../data/incomeSimulated.csv) with the code below.

```{r}
incomeSimulated |>
  summarize(estimated_median = median(hhincome))
```

This code starts with the `incomeSimulated` data and uses the pipe operator `|>` to pass the data to the `summarize()` function. The summarize function creates a new variable `estimated_median` which contains the median value of `hhincome`, calculated by applying the `median()` function to this variable. The `median()` function takes a vector of values and returns a single summary. The `summarize()` function converts our data that had `r nrow(incomeSimulated)` rows into a new format that has only 1 row containing the summary statistic.

One can also produce several summary statistics. The median is a useful measure of central tendency: it gives a sense of the income value in the middle of the distribution. But it may not give us a good sense of inequality, which requires some sense of the spread of the distribution. One may therefore want other summary statistics, such as the 90th and 10th percentiles. The 90th percentile is the household income value such that 90\% of households have lower incomes. The 10th percentile is the value such that 10\% of households have lower incomes.

```{r, echo = F, comment = F, message = F, warning = F, fig.width = 6, fig.height = 2}
p +
  geom_vline(xintercept = summaries$q90,
             color = "blue", size = 2) +
  geom_vline(xintercept = summaries$q10,
             color = "seagreen4", size = 2) +
  annotate(geom = "text", color = "blue", size = 4,
           x = 375e3, y = 2e7,
           label = paste0("90th percentile (",scales::dollar(summaries$q90),")"),
           fontface = "bold") +
  annotate(geom = "text", color = "black", size = 4,
           x = 375e3, y = 1.5e7,
           label = paste0("gets ",
                          round(summaries$q90 / summaries$q10),
                          "x as much as the")) +
  annotate(geom = "text", color = "seagreen4", size = 4,
           x = 375e3, y = 1e7,
           label = paste0("10th percentile (",scales::dollar(summaries$q10),")"),
           fontface = "bold")
#ggsave("../slides/lec1/us2022_hh_dist_9010.pdf",
#       height = 3, width = 4.5)
```

Below, we produce these summaries in the simulated data. Note that the `summarize()` function can produce several new variables containing several estimated summary statistics. Here we use the `quantile` function to produce the percentile estimates.

```{r}
incomeSimulated |>
  summarize(
    estimated_median = median(x = hhincome),
    estimated_10th_percentile = quantile(x = hhincome, probs = .1),
    estimated_90th_percentile = quantile(x = hhincome, probs = .9)
  )
```

## How to choose a summary statistic?

The choice of summary statistic involves a subjective (non-empirical) choice about what aspect of the distribution is important to report. If you are normatively concerned with the growth of high incomes, you might want to summarize the 90th or even 99th percentile of the distribution. If you are concerned with the typical household, you might want to summarize by the median. If you are interested in patterns of inequality among low earners, you might summarize with the 10th percentile.
