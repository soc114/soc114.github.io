{
  "hash": "93f28021a9fcbf23a5343787de53b00c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Conditional exchangeability\"\n---\n\n::: {.cell}\n\n:::\n\n\n\n\nConditional exchangeability is an assumption that exchangeability holds within population subgroups. This assumption holds by design in a conditionally randomized experiment (discussed on this page), and may hold under certain causal beliefs in observational settings where the treatment is not randomized (next page).\n\n<!-- This page introduces conditional exchangeability as well as Directed Acyclic Graphs (DAGs), which formalize causal assumptions in a visual graph. One way DAGs are useful is that they can help us find a way to create subpopulations such that conditional exchangeability holds. -->\n\n<!-- ### Why observational studies? -->\n\n<!-- This is why randomized experiment remain a gold standard for causal inference. Yet there also exist questions that demand causal answers but for which randomized experiments are too costly or even perhaps unethical. We might want to know the causal effect of parental incarceration on child developmental outcomes, but it would be unethical to randomly incarcerate some parents. We might want to know the average causal effect of a four-year college degree on socioeconomic outcomes, to inform policy questions about expanding access to education. But we cannot randomize some people to get degrees while randomizing others to be prevented from getting degrees. -->\n\n<!-- When randomization is not possible, one of the most compelling alternatives is to rely on an assumption of conditional exchangeability. -->\n\n\n\n<!-- One way to think about conditional exchangeability is in terms of a conditionally randomized experiment. Another way is to think in terms of the outcomes of observationally-identical people. -->\n\n## A conditionally randomized experiment\n\nSuppose we were to carry out an experiment on a simple random sample of U.S. high school students. Among those performing in the top 25\\% of their high school class, we randomize 80\\% to attain a four-year college degree. Among those performing in the bottom 75\\% of their high school class, we randomize 20\\% to attain a four-year college degree. We are interested in effects on employment at age 40 ($Y$).\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](conditional_exchangeability_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\nThis experiment is **conditionally randomized** because the probability of treatment (four-year degree) is different among the higher- and lower-performing high school students.\n\n> **Conditionally randomized experiment.** An experiment in which the probability of treatment assignment depends on the values of pre-treatment covariates. $\\text{P}(A = 1\\mid\\vec{X} = \\vec{x})$ depends on the value $\\vec{x}$.\n\n## Conditional exchangeability\n\nIn a conditionally randomized experiment, exchangeability is not likely to hold. People who are treated (assigned to a four-year degree) are more likely to have come from the top 25\\% of their high school class. They might be especially hard-working people. The treated and untreated might have had different employment at age 40 even if none of them had been treated.\n\nEven though exchangeability does not hold marginally (across everyone), in a conditionally randomized experiment exchangeability does hold within subgroups. If we focus on those in the top 25\\% of the class, the 90\\% who are assigned to finish college are a simple random sample of the entire higher-performing subgroup. If we focus on those in the bottom 75\\% of the class, the 10\\% who are assigned to finish college are a simple random sample of the entire lower-performing subgroup.\n\nFormally, conditional exchangeability takes the exchangeability assumption ($\\{Y^0,Y^1\\}\\unicode{x2AEB}A$) and adds a conditioning bar $\\mid\\vec{X}$, meaning that this assumption holds within subgroups defined by one or more pre-treatment variables $\\vec{X}$.\n\n> **Conditional exchangeability.** The assumption that potential outcomes $\\{Y^0,Y^1\\}$ are independent of treatment $A$ among subpopulations that are identical along a set of pre-treatment covariates $\\vec{X}$. Formally, $\\{Y^0,Y^1\\} \\unicode{x2AEB} A \\mid \\vec{X}$.\n\nConditional exchangeability holds by design in conditionally randomized experiments: the probability of treatment assignment differs across subgroups, but within each subgroup we have a simple randomized experiment where each unit has an equal probability of being treated.\n\n## Conditional average treatment effects\n\nIn our conditionally randomized experiment, we could identify conditional average treatment effects: the average effects of college on employment at age 40 (1) among those in the top 25\\% of their high school class, and the and (2) among those in the bottom 75\\% of their high school class. \n\n> **Conditional average treatment effect (CATE).** The average causal effect within a population subgroup, $\\tau(x) = \\text{E}\\left(Y^1\\mid\\vec{X} = \\vec{x}\\right) - \\text{E}\\left(Y^0\\mid \\vec{X} = \\vec{x}\\right)$.\n\nOnce we assume conditional exchangeability and consistency, CATEs are causally identified by working within a subgroup defined by $\\vec{X} = \\vec{x}$ and taking the difference in means across subgroups of units assigned to treatment and control.\n\n$$\n\\begin{aligned}\n&\\text{E}\\left(Y^1\\mid\\vec{X} = \\vec{x}\\right) -  \\text{E}\\left(Y^0\\mid\\vec{X} = \\vec{x}\\right)\\\\\n&= \\text{E}\\left(Y\\mid\\vec{X} = \\vec{x}, A = 1\\right) - \\text{E}\\left(Y\\mid\\vec{X} = \\vec{x}, A = 0\\right)\n\\end{aligned}\n$$\n\nIn our concrete example, this means that we could first focus on the subgroup for whom $\\vec{X} = (\\text{Top 25\\% of high school class})$. Within this subgroup, we can compare employment at age 40 among those randomized to a 4-year college degree to employment at age 40 among those randomized to finish education after high school. This mean difference identifies the CATE: the average causal effect of college among those in the top 25\\% of their high school class.\n\nLikewise, our experiment would also identify the CATE among those in the bottom 75\\% of their high school class.\n\n## Effect heterogeneity\n\nThere are often good reasons to expect the Conditional Average Treatment Effect (CATE) to differ across subpopulations. In our example, suppose that those from the top 25\\% of the high school class are very creative and hard-working, and would find ways to be employed at age 40 regardless of whether they finished college. The average causal effect of college on employment in this subgroup might be small. Meanwhile, the average causal effect of college on employment might be quite large among those from the bottom 75\\% of their high school class. This would be an example of effect heterogeneity,\n\n> **Effect heterogeneity.** Differences in Conditional Average Treatment Effects (CATEs) across subpopulations. $\\tau(\\vec{x})\\neq\\tau(\\vec{x}')$.\n\nAn advantage of analyzing randomized experiments conditionally (within subgroups) is that one can search for effect heterogeneity.\n\n",
    "supporting": [
      "conditional_exchangeability_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}