<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Directed Acyclic Graphs – Social Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../topics/13_matching.html" rel="next">
<link href="../topics/11_exchangeability.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-3a5424b299dd0b10ec444f85821f6826.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Social Data Science</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../assets/syllabus.pdf"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../calendar.html"> 
<span class="menu-text">Calendar</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-problem-sets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Problem Sets</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-problem-sets">    
        <li>
    <a class="dropdown-item" href="../psets/pset1.html">
 <span class="dropdown-text">Problem Set 1: Code Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../psets/pset2.html">
 <span class="dropdown-text">Problem Set 2: Visualization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../psets/pset3.html">
 <span class="dropdown-text">Problem Set 3: Estimator and Bootstrap</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../psets/pset4.html">
 <span class="dropdown-text">Problem Set 4: Statistical Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../psets/pset5.html">
 <span class="dropdown-text">Problem Set 5: Income Prediction Challenge</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../psets/pset6.html">
 <span class="dropdown-text">Problem Set 6: Potential Outcomes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../psets/pset7.html">
 <span class="dropdown-text">Problem Set 7: Experiments</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://piazza.com/class/miyskvk64nv4y1"> 
<span class="menu-text">Piazza</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-honors-section" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Honors Section</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-honors-section">    
        <li>
    <a class="dropdown-item" href="../honors/welcome.html">
 <span class="dropdown-text">Welcome</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../honors/ask_good_questions.html">
 <span class="dropdown-text">Asking questions with data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../honors/access_data.html">
 <span class="dropdown-text">Accessing data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../honors/prepare_data.html">
 <span class="dropdown-text">Preparing data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../honors/sketch_a_visualization.html">
 <span class="dropdown-text">Sketching a visualization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../honors/writing.html">
 <span class="dropdown-text">Writing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../honors/presentation.html">
 <span class="dropdown-text">Presenting orally</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://forms.gle/KZUdBH6bhkXtRxZX7"> 
<span class="menu-text">Extension Requests</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../past_sites.html"> 
<span class="menu-text">Past Year Sites</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../topics/10_define_causal.html">Causal Inference with Measured Confounding</a></li><li class="breadcrumb-item"><a href="../topics/12_DAGs.html">Directed Acyclic Graphs</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/1a_empirical_questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Questions in Social Data Science</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/1b_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software Prerequisites</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/1c_r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics of R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/2a_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualizing a Distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/2b_summary_statistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/3_sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Population Sampling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/4_ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Confidence Intervals</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Models for Subgroup Summaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/5_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/6_logistic_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/7_forests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Forests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/8_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Economic Opportunity Measured by Predictability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/8b_sample_splitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sample Splitting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/9a_data_driven_selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data-Driven Estimator Selection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/9_are_complex_better.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Are Complex Models Better?</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Causal Inference with Measured Confounding</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/10_define_causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Defining Causal Effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/11_exchangeability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exchangeability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/12_DAGs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Directed Acyclic Graphs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/13_matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matching</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/14_models_for_causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Models for Causal Inference</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Causal Inference with Unmeasured Confounding</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/15_did.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Difference in Difference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/16_rd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Discontinuity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../topics/17_iv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instrumental Variables</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#nodes-edges-and-paths" id="toc-nodes-edges-and-paths" class="nav-link active" data-scroll-target="#nodes-edges-and-paths">Nodes, edges, and paths</a></li>
  <li><a href="#causal-paths" id="toc-causal-paths" class="nav-link" data-scroll-target="#causal-paths">Causal paths</a></li>
  <li><a href="#fork-structures" id="toc-fork-structures" class="nav-link" data-scroll-target="#fork-structures">Fork structures</a></li>
  <li><a href="#collider-structures" id="toc-collider-structures" class="nav-link" data-scroll-target="#collider-structures">Collider structures</a></li>
  <li><a href="#open-and-blocked-paths" id="toc-open-and-blocked-paths" class="nav-link" data-scroll-target="#open-and-blocked-paths">Open and blocked paths</a></li>
  <li><a href="#determining-statistical-dependence" id="toc-determining-statistical-dependence" class="nav-link" data-scroll-target="#determining-statistical-dependence">Determining statistical dependence</a></li>
  <li><a href="#causal-identification-with-dags" id="toc-causal-identification-with-dags" class="nav-link" data-scroll-target="#causal-identification-with-dags">Causal identification with DAGs</a></li>
  <li><a href="#how-to-draw-a-dag" id="toc-how-to-draw-a-dag" class="nav-link" data-scroll-target="#how-to-draw-a-dag">How to draw a DAG</a></li>
  <li><a href="#closing-thoughts" id="toc-closing-thoughts" class="nav-link" data-scroll-target="#closing-thoughts">Closing thoughts</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../topics/10_define_causal.html">Causal Inference with Measured Confounding</a></li><li class="breadcrumb-item"><a href="../topics/12_DAGs.html">Directed Acyclic Graphs</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Directed Acyclic Graphs</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Here are <a href="../slides/lec12_dags/lec12_dags.pdf">slides</a>.</p>
</blockquote>
<p>Directed Acyclic Graphs (DAGs) formalize causal assumptions mathematically in graphs. One way DAGs are useful in observational studies is by helping us to identify a sufficient adjustment set (<span class="math inline">\(\vec{X}\)</span>) such that conditional exchangeability holds.</p>
<section id="nodes-edges-and-paths" class="level2">
<h2 class="anchored" data-anchor-id="nodes-edges-and-paths">Nodes, edges, and paths</h2>
<p>The previous page introduced a conditionally randomized experiment in which the researcher assigned participants to the treatment condition of (four-year college degree) vs (high school degree) with probabilities that depended on high school class rank. In this experiment, being in the top 25% of one’s high school class caused a higher chance of receiving the treatment. We will also assume that both high school performance and college completion may causally shape employment at age 40.</p>
<p>We can formalize these ideas in a graph where each <strong>node</strong> (a letter) is a variable and each <strong>edge</strong> (<span class="math inline">\(\rightarrow\)</span>) is a causal relationship.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12_DAGs_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Between each pair of nodes, you can enumerate every <strong>path</strong> or sequence of edges connecting the nodes.</p>
<blockquote class="blockquote">
<p><strong>Path.</strong> A path between nodes <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is any set of edges that starts at <span class="math inline">\(A\)</span> and ends at <span class="math inline">\(B\)</span>. Paths can involve arrows in either direction.</p>
</blockquote>
<p>In our DAG above, there are two paths between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(A\rightarrow Y\)</span></li>
<li><span class="math inline">\(A\leftarrow X \rightarrow Y\)</span></li>
</ol>
<p>We use paths to determine the reasons why <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span> might be statistically dependent or independent.</p>
</section>
<section id="causal-paths" class="level2">
<h2 class="anchored" data-anchor-id="causal-paths">Causal paths</h2>
<p>The first type of path that we consider is a causal path.</p>
<blockquote class="blockquote">
<p><strong>Causal path.</strong> A path in which all arrows point in the same direction. For example, <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> could be connected by a causal path <span class="math inline">\(A\rightarrow B \rightarrow C \rightarrow D\)</span>.</p>
</blockquote>
<p>A causal path creates statistical depends between the nodes because the first node causes the last node, possibly through a sequence of other nodes.</p>
<p>In our example, there is a causal path <span class="math inline">\(A\rightarrow Y\)</span>: being assigned to a four-year college degree affects employment at age 40. Because of this causal path, people who are assigned to a four-year degree have different rates of employment at age 40 than those who are not.</p>
<p>A causal path can go through several variables. For example, if we listed the paths between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> we would include the path <span class="math inline">\(X\rightarrow A \rightarrow Y\)</span>. This is a causal path because being in the top 25% of one’s high school class increases the probability of assignment to a four-year degree in our experiment, which in turn increases the probability of employment at age 40.</p>
</section>
<section id="fork-structures" class="level2">
<h2 class="anchored" data-anchor-id="fork-structures">Fork structures</h2>
<p>To reason about non-causal paths, we have to think about several structures that can exist along these paths. The first such structure is a fork structure.</p>
<blockquote class="blockquote">
<p><strong>Fork structure.</strong> A fork structure is a sequence of edges in which two variables (<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>) are both caused a third variable (<span class="math inline">\(C\)</span>): <span class="math inline">\(A\leftarrow C \rightarrow B\)</span>.</p>
</blockquote>
<p>In our example, the path <span class="math inline">\(A\leftarrow X \rightarrow Y\)</span> involves a fork structure. being in the top 25% of one’s high school class causally affects both the treatment (college degree) and the outcome (employment at age 40).</p>
<p>A fork structure creates statistical dependence between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span> that does not correspond to a causal effect of <span class="math inline">\(A\)</span> on <span class="math inline">\(Y\)</span>. In our example, people who are assigned to the treatment value (college degree) are more likely to have been in the top 25% of their high school class, since this high class rank affected treatment assignment in our experiment. A high class rank also affected employment at age 40. Thus, in our experiment the treatment would be associated with the outcome even if finishing college had no causal effect on employment.</p>
<p>Fork structures can be <strong>blocked</strong> by conditioning on the common cause. In our example, suppose we filter our data to only include those in the top 25% of their high school class. We sometimes use a box to denote conditioning on a variable, (<span class="math inline">\(A\leftarrow\boxed{X}\rightarrow Y\)</span>). Conditioning on <span class="math inline">\(X\)</span> blocks the path because within this subgroup <span class="math inline">\(X\)</span> does not vary, so it cannot cause the values of <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span> within the subgroup. In our example, if we looked among those in the top 25% of their high school classes the only reason college enrollment would be related to employment at age 40 would be the causal effect <span class="math inline">\(A\rightarrow Y\)</span>.</p>
<p>To emphasize ideas, it is also helpful to consider a fork structure in an example where the variables have no causal relationship.</p>
<p>Suppose a beach records for each day the number of ice cream cones sold and the number of rescues by lifeguards. There is no causal effect between these two variables; eating ice cream does not cause more lifeguard rescues and vice versa. But the two are correlated because they share a common cause: warm temperatures cause high ice cream sales and also high lifeguard rescues. A fork structure formalizes this notion: <span class="math inline">\((\text{ice cream sales}) \leftarrow (\text{warm temperature}) \rightarrow (\text{lifeguard rescues})\)</span>.</p>
<p>In the population of days as a whole, this fork structure means that ice cream sales are related to lifeguard rescues. But if we condition on having a warm temperature by filtering to days when the temperature took a particular value, ice cream sales would be unrelated to lifeguard rescues across those days. This is the sense in which conditioning on the common cause variable blocks the statistical associations that would otherwise arise from a fork structure.</p>
</section>
<section id="collider-structures" class="level2">
<h2 class="anchored" data-anchor-id="collider-structures">Collider structures</h2>
<p>In contrast to a fork structure where one variable affects two others (<span class="math inline">\(\bullet\leftarrow\bullet\rightarrow\bullet\)</span>), a <strong>collider structure</strong> is a structure where one variable is affected by two others.</p>
<blockquote class="blockquote">
<p><strong>Collider structure.</strong> A collider structure is a sequence of edges in which two variables (<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>) both cause a third variable (<span class="math inline">\(C\)</span>). We say that <span class="math inline">\(C\)</span> is a <strong>collider</strong> on the path <span class="math inline">\(A\rightarrow C \leftarrow B\)</span>.</p>
</blockquote>
<p>Fork and collider structures have very different properties, as we will illustrate through an example.</p>
<p>Suppose that every day I observe whether the grass on my lawn is wet. I have sprinklers that turn on with a timer at the same time every day, regardless of the weather. It also sometimes rains. When the grass is wet, it is wet because either the sprinklers have been on or it has been raining.</p>
<p><span class="math display">\[
(\text{sprinklers on}) \rightarrow (\text{grass wet}) \leftarrow (\text{raining})
\]</span></p>
<p>If I look across all days, the variable (sprinklers on) is unrelated to the variable (raining). After all, the sprinklers are just on a timer! Formally, we say that even though (sprinklers on) and (raining) are connected by the path above, this path is <strong>blocked</strong> by the collider structure. A path does not create dependence between two variables when it contains a collider structure.</p>
<p>If I look only at the days when the grass is wet, a different pattern emerges. If the grass is wet and the sprinklers have not been on, then it must have been raining: the grass had to get wet somehow. If the grass is wet and it has not been raining, then the sprinklers must have been on. Once I look at days when the grass is wet (or <strong>condition</strong> on the grass being wet), the two input variables become statistically associated.</p>
<p>A collider blocks a path when that collider is left unadjusted, but conditioning on the collider variable opens the path containing the collider.</p>
</section>
<section id="open-and-blocked-paths" class="level2">
<h2 class="anchored" data-anchor-id="open-and-blocked-paths">Open and blocked paths</h2>
<p>A central purpose of a DAG is to connect causal assumptions to implications about associations that should be present (or absent) in data under those causal assumptions. To make this connection, we need a final concept of open and blocked paths.</p>
<blockquote class="blockquote">
<p>A path is <strong>blocked</strong> if it contains an unconditioned collider or a conditioned non-collider. Otherwise, the path is <strong>open</strong>. An open path creates statistical dependence between its terminal nodes whereas a blocked path does not.</p>
</blockquote>
<p>As examples for a path with no colliders,</p>
<ul>
<li><span class="math inline">\(A\leftarrow B \rightarrow C \rightarrow D\)</span> is an open path because no variables are conditioned and it contains no colliders.</li>
<li><span class="math inline">\(A\leftarrow \boxed{B}\rightarrow C \rightarrow D\)</span> is a blocked path because we have conditioned on the non-collider <span class="math inline">\(B\)</span>.</li>
<li><span class="math inline">\(A\leftarrow  B\rightarrow \boxed{C} \rightarrow D\)</span> is a blocked path because we have conditioned on the non-collider <span class="math inline">\(C\)</span>.</li>
</ul>
</section>
<section id="determining-statistical-dependence" class="level2">
<h2 class="anchored" data-anchor-id="determining-statistical-dependence">Determining statistical dependence</h2>
<p>We are now ready to use DAGs to determine if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are statistically dependent. The process involves three steps.</p>
<ol type="1">
<li>List all paths between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</li>
<li>Cross out any paths that are blocked.</li>
<li>The causal assumptions imply that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> may be statistically dependent only if any open paths remain.</li>
</ol>
<p>As an example, below we consider a hypothetical DAG.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12_DAGs_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>1. Marginal dependence</strong></p>
<p>Marginally without any adjustment, are <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> statistically dependent? We first write out all paths connecting <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span>.</p>
<ul>
<li><span class="math inline">\(A\rightarrow B \leftarrow C\rightarrow D\)</span></li>
<li><span class="math inline">\(A\leftarrow X\rightarrow D\)</span></li>
</ul>
<p>We then cross out the paths that are blocked</p>
<ul>
<li><span class="math inline">\(\cancel{A\rightarrow B \leftarrow C\rightarrow D}\)</span> (blocked by unconditioned collider <span class="math inline">\(B\)</span>)</li>
<li><span class="math inline">\(A\leftarrow X\rightarrow D\)</span></li>
</ul>
<p>Because an open path remains, <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> are statistically dependent.</p>
<p><strong>2. Dependence conditional on <span class="math inline">\(X\)</span></strong></p>
<p>If we condition on <span class="math inline">\(X\)</span>, are <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> statistically dependent? We first write out all paths connecting <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span>.</p>
<ul>
<li><span class="math inline">\(A\rightarrow B \leftarrow C\rightarrow D\)</span></li>
<li><span class="math inline">\(A\leftarrow \boxed{X}\rightarrow D\)</span></li>
</ul>
<p>We then cross out the paths that are blocked</p>
<ul>
<li><span class="math inline">\(\cancel{A\rightarrow B \leftarrow C\rightarrow D}\)</span> (blocked by unconditioned collider <span class="math inline">\(B\)</span>)</li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X}\rightarrow D}\)</span> (blocked by conditioned non-collider <span class="math inline">\(X\)</span>)</li>
</ul>
<p>Because no open path remains, <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> are statistically independent.</p>
<p><strong>3. Dependence conditional on <span class="math inline">\(\{X,B\}\)</span></strong></p>
<p>If we condition on <span class="math inline">\(X\)</span> and <span class="math inline">\(B\)</span>, are <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> statistically dependent? We first write out all paths connecting <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span>.</p>
<ul>
<li><span class="math inline">\(A\rightarrow B \leftarrow C\rightarrow D\)</span></li>
<li><span class="math inline">\(A\leftarrow \boxed{X}\rightarrow D\)</span></li>
</ul>
<p>We then cross out the paths that are blocked</p>
<ul>
<li><span class="math inline">\(A\rightarrow \boxed{B} \leftarrow C\rightarrow D\)</span> (open since collider <span class="math inline">\(B\)</span> is conditioned)</li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X}\rightarrow D}\)</span> (blocked by conditioned non-collider <span class="math inline">\(X\)</span>)</li>
</ul>
<p>Because an open path remains, <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> are statistically dependent.</p>
</section>
<section id="causal-identification-with-dags" class="level2">
<h2 class="anchored" data-anchor-id="causal-identification-with-dags">Causal identification with DAGs</h2>
<p>When our aim is to identify the average causal effect of <span class="math inline">\(A\)</span> on <span class="math inline">\(Y\)</span>, we want to choose a set of variables for adjustment so that all remaining paths are causal paths. We call this a sufficient adjustment set.</p>
<blockquote class="blockquote">
<p>A <strong>sufficient adjustment set</strong> for the causal effect of <span class="math inline">\(A\)</span> on <span class="math inline">\(Y\)</span> is a set of nodes that, when conditioned, block all non-causal paths between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span>.</p>
</blockquote>
<p>In our example from the top of this page, there were two paths between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span>:</p>
<ul>
<li><span class="math inline">\((A\text{: college degree})\rightarrow (Y\text{: employed at age 40})\)</span></li>
<li><span class="math inline">\((A\text{: college degree})\leftarrow (X\text{: top 25\% of high school class})\rightarrow (Y\text{: employed at age 40})\)</span></li>
</ul>
<p>In this example, <span class="math inline">\(X\)</span> is a sufficient adjustment set. Once we condition on <span class="math inline">\(X\)</span> by e.g.&nbsp;filtering to those in the top 25% of their high school class, the only remaining path between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span> is the causal path <span class="math inline">\(A\rightarrow Y\)</span>. Thus, the difference in means in <span class="math inline">\(Y\)</span> across <span class="math inline">\(A\)</span> within subgroups defined by <span class="math inline">\(X\)</span> identifies the conditional average causal effect of <span class="math inline">\(A\)</span> on <span class="math inline">\(Y\)</span>.</p>
<p><strong>A more difficult example.</strong></p>
<p>Sufficient adjustment sets can be much more complicated. As an example, consider the DAG below.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12_DAGs_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We first list all paths between <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(A\rightarrow Y\)</span></li>
<li><span class="math inline">\(A\rightarrow M\rightarrow Y\)</span></li>
<li><span class="math inline">\(A\leftarrow X_1\rightarrow X_3 \rightarrow Y\)</span></li>
<li><span class="math inline">\(A\leftarrow X_1\rightarrow X_3 \leftarrow X_2\rightarrow Y\)</span></li>
<li><span class="math inline">\(A\leftarrow X_3 \rightarrow Y\)</span></li>
<li><span class="math inline">\(A\leftarrow X_3\leftarrow X_2 \rightarrow Y\)</span></li>
</ol>
<p>The first two paths are causal, and the others are non-causal. We want to find a sufficient adjustment set to block all the non-causal paths.</p>
<p>In order to block paths (3), (5), and (6) we might condiiton on <span class="math inline">\(X_3\)</span>. But doing so opens path (2), which was otherwise blocked by the collider <span class="math inline">\(X_3\)</span>. In order to also block path (2), we might additionally condition on <span class="math inline">\(X_1\)</span>. In this case, our sufficient adjustment set is <span class="math inline">\(\{X_1,X_3\}\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(A\rightarrow Y\)</span></li>
<li><span class="math inline">\(A\rightarrow M\rightarrow Y\)</span></li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X_1}\rightarrow \boxed{X_3} \rightarrow Y}\)</span></li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X_1}\rightarrow \boxed{X_3} \leftarrow X_2\rightarrow Y}\)</span></li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X_3} \rightarrow Y}\)</span></li>
<li><span class="math inline">\(\cancel{A\leftarrow \boxed{X_3}\leftarrow X_2 \rightarrow Y}\)</span></li>
</ol>
<p>Then the only open paths are paths (1) and (2), both of which are causal paths from <span class="math inline">\(A\)</span> to <span class="math inline">\(Y\)</span>.</p>
<p>Sometimes there are several sufficient adjustment sets. In this example, sufficient adjustment sets include:</p>
<ul>
<li><span class="math inline">\(\{X_1,X_3\}\)</span></li>
<li><span class="math inline">\(\{X_2,X_3\}\)</span></li>
<li><span class="math inline">\(\{X_1,X_2,X_3\}\)</span></li>
</ul>
<p>We sometimes call the first two minimal sufficient adjustment sets because they are the smallest.</p>
<blockquote class="blockquote">
<p>A <strong>minimal sufficient adjustment set</strong> is an adjustment set that achieves causal identification by conditioning on the fewest number of variables possible.</p>
</blockquote>
</section>
<section id="how-to-draw-a-dag" class="level2">
<h2 class="anchored" data-anchor-id="how-to-draw-a-dag">How to draw a DAG</h2>
<p>So far, we have focused on causal identification with a DAG that has been given. But how do you draw one for yourself?</p>
<p>When drawing a DAG, there is an important rule: any node that would have edges pointing into any two nodes already represented in the DAG must be included. This is because what you omit from the DAG is far more important than what you include in the DAG. Many of your primary assumptions are about the nodes and edges that you leave out.</p>
<p>For example, suppose we are estimating the causal effect of a college degree on employment at age 40. After beginning our DAG with only these variables, we have to think about any other variables that might affect these two. High school performance is one example. Then we have to include any nodes that affect any two of {high school performance, college degree, employment at age 40}. Perhaps a person’s parents’ education affects that person’s high school performance and college degree attainment. Then parents’ education should be included as an additional node. The cycle continues, so that in observational causal inference settings you are likely to have a DAG with many nodes.</p>
<p>In practice, you may not have data on all the nodes that comprise the sufficient adjustment set in your graph. In this case, we recommend that you first draw a graph under which you can form a sufficient adjustment set with the measured variables. This allows you to state one set of causal beliefs under which your analysis can answer your causal question. Then, also draw a second DAG that includes the other variables you think are relevant. This will enable you to reason about the sense in which your results could be misleading because of omitting important variables.</p>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing thoughts</h2>
<p>DAGs are a powerful tool for causal inference, because they are both visually intuitive and mathematically precise. They translate our theories about the world into a formal language with implications for causal identification.</p>
<p>If you’d like to learn more about DAGs, here are a few good resources:</p>
<ul>
<li>Pearl, Judea, and Dana Mackenzie. 2018. <a href="https://www.hachettebookgroup.com/titles/judea-pearl/the-book-of-why/9781541698963"><strong>The Book of Why: The New Science of Cause and Effect.</strong></a> New York: Basic Books.</li>
<li>Pearl, Judea, Madelyn Glymour, and Nicholas P. Jewell. 2016. <a href="https://bayes.cs.ucla.edu/PRIMER/"><strong>Causal Inference in Statistics: A Primer.</strong></a> New York: Wiley.</li>
</ul>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../topics/11_exchangeability.html" class="pagination-link" aria-label="Exchangeability">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Exchangeability</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../topics/13_matching.html" class="pagination-link" aria-label="Matching">
        <span class="nav-page-text">Matching</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>